<?xml version="1.0" encoding="UTF-8"?>
<project name="RI" default="help">

	<property name="terminal.root" value="." />
	<property name="terminal.lib_dst" value="${terminal.root}/libs" />
	<property name="terminal.lib_src1" value="${terminal.root}/../mediaplayer" />
	<property name="terminal.lib_src2" value="${terminal.root}/../core" />
	<property name="terminal.target1" value="rcs_media.jar" />
	<property name="terminal.target2" value="rcs_api.jar" />
	<property name="terminal.target3" value="rcs_cnx.jar" />
	<property name="terminal.classes3.dir" value="${terminal.root}/bin/classes" />
	
	<target name="libs">
		<ant antfile="build-local.xml" target="jar" dir="${terminal.lib_src1}"/>
		<echo>Copy ${terminal.target1} file</echo>
		<copy file="${terminal.lib_src1}/${terminal.target1}" todir="${terminal.lib_dst}" />
		<copy todir="${terminal.lib_dst}/armeabi" >  
			<fileset dir="${terminal.lib_src1}/libs/armeabi" includes="**" />
		</copy>
		<ant antfile="build.xml" target="api" dir="${terminal.lib_src2}"/>
		<echo>Copy ${terminal.target2} file</echo>
		<copy file="${terminal.lib_src2}/${terminal.target2}" todir="${terminal.lib_dst}" />
	</target>

	<target name="jar">
		<echo>Generate ${terminal.target3} file</echo>
		<jar destfile="${terminal.target3}" filesonly="true">
			<fileset dir="${terminal.classes3.dir}" includes="com/orangelabs/rcs/ri/ConnectionManager*" />
			<fileset dir="${terminal.classes3.dir}" includes="com/orangelabs/rcs/ri/utils/LockAccess*" />
			<fileset dir="${terminal.classes3.dir}" includes="com/orangelabs/rcs/ri/utils/LogUtils*" />
		</jar>
	</target>
	
	<target name="clean">
		<echo>Delete library files</echo>
		<delete file="${terminal.lib_dst}/${terminal.target1}"/>
		<delete file="${terminal.lib_dst}/${terminal.target2}"/>
		<delete includeemptydirs="true">
			<fileset dir="${terminal.lib_dst}" includes="**/armeabi/"/>
		</delete>
		<delete file="${terminal.lib_dst}/${terminal.target3}"/>
	</target>

	<target name="all" depends="clean,libs" />

	<target name="help">
		<echo>Library Ant Build. Available targets:</echo>
		<echo> help: Displays this help.</echo>
		<echo> clean: Removes output files created by other targets.</echo>
		<echo> libs: Generate input libraries.</echo>
		<echo> jar: Create output library (for other projects).</echo>
		<echo> all: Deletes then copy input libraries.</echo>
	</target>

</project>
